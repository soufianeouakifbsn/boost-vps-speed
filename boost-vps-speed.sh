#!/bin/bash
# Ø³ÙƒØ±Ø¨Øª Ù…ÙØ¹Ø¯Ù‘ÙŽÙ„ Ù„Ø¶Ø¨Ø· Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª sysctl ÙˆÙ…Ø­Ø§ÙˆÙ„Ø© ØªÙ…ÙˆÙŠÙ‡ Ø§ØªØµØ§Ù„Ø§Øª UDP (ÙŠØªØ·Ù„Ø¨ ØªÙƒÙˆÙŠÙ† VPN Ù…Ù†ÙØµÙ„) ðŸš€

echo "ðŸ”§ ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø´Ø¨ÙƒØ© ÙˆÙ…Ø­Ø§ÙˆÙ„Ø© ØªÙ…ÙˆÙŠÙ‡ UDP..."

# ==== ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø´Ø¨ÙƒØ© (Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù…Ù…ÙŠØ²Ø©) ====

# Ù‚ÙŠÙ… Ø°Ø§ÙƒØ±Ø© TCP (Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª VPN Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ)
net.core.rmem_default = 2097152
net.core.rmem_max = 33554432
net.core.wmem_default = 2097152
net.core.wmem_max = 33554432

net.ipv4.tcp_rmem = 4096 87380 33554432
net.ipv4.tcp_wmem = 4096 65536 33554432

# Ø­Ø¬Ù… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
net.core.netdev_max_backlog = 100000
net.core.somaxconn = 65536

# Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… (Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ¬Ø±Ø¨Ø© Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ù…Ø®ØªÙ„ÙØ©)
net.core.default_qdisc=fq_codel
net.ipv4.tcp_congestion_control = cubic # Ø£Ùˆ bbr Ø£Ùˆ ØºÙŠØ±Ù‡Ø§

net.ipv4.tcp_mtu_probing = 0 # ØªØ¹Ø·ÙŠÙ„ probing Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ù…ÙŠØ²Ø©
net.ipv4.tcp_no_metrics_save = 1
net.ipv4.tcp_window_scaling = 1

# TCP Fast Open
net.ipv4.tcp_fastopen = 3

# Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ù†Ø§ÙØ° Ø§Ù„Ù…Ø­Ù„ÙŠØ©
net.ipv4.ip_local_port_range = 1024 65535

# Ù…Ù‡Ù„Ø§Øª TCP (Ù‚ÙŠÙ… Ù…ØªØ­ÙØ¸Ø©)
net.ipv4.tcp_fin_timeout = 15
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_tw_recycle = 0 # ØªØ¹Ø·ÙŠÙ„ recycle Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ NAT

# ØªØ¹Ø·ÙŠÙ„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.all.send_redirects = 0

# ØªØ­Ø³ÙŠÙ†Ø§Øª TCP
net.ipv4.tcp_moderate_rcvbuf = 1
net.ipv4.tcp_timestamps = 0
net.ipv4.tcp_sack = 1

net.core.optmem_max = 2048000
net.ipv4.tcp_slow_start_after_idle = 0

# ØªØ¹Ø·ÙŠÙ„ IPv6 Ø¥Ø°Ø§ ÙƒÙ†Øª Ù„Ø§ ØªØ³ØªØ®Ø¯Ù…Ù‡ (ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙ‚Ù„Ù„ Ù…Ù† Ø§Ù„ØªØ¹Ù‚ÙŠØ¯)
net.ipv6.conf.all.disable_ipv6 = 1

# ==== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø­ØªÙ…Ù„Ø© Ù„ØªÙ…ÙˆÙŠÙ‡ UDP (Ù‚Ø¯ Ù„Ø§ ØªÙƒÙˆÙ† ÙƒÙ„Ù‡Ø§ Ø¶Ø±ÙˆØ±ÙŠØ© Ø£Ùˆ Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§) ====

# **Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©:** Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ Ù‡ÙŠ Ù…ÙØ§Ù‡ÙŠÙ…ÙŠØ© ÙˆÙ‚Ø¯ Ù„Ø§ ÙŠÙƒÙˆÙ† Ù„Ù‡Ø§ ØªØ£Ø«ÙŠØ± Ù…Ø¨Ø§Ø´Ø± Ø¹Ù„Ù‰ ØªÙ…ÙˆÙŠÙ‡ UDP
# Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ sysctl. ØªÙ…ÙˆÙŠÙ‡ UDP ÙŠØªÙ… ØªØ­Ù‚ÙŠÙ‚Ù‡ Ø¨Ø´ÙƒÙ„ Ø£Ø³Ø§Ø³ÙŠ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¨Ø±Ù†Ø§Ù…Ø¬ VPN Ù†ÙØ³Ù‡.

echo "âš ï¸ **ØªØ­Ø°ÙŠØ±:** Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªÙ…ÙˆÙŠÙ‡ UDP ØªØ¹ØªÙ…Ø¯ Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ Ø¨Ø±Ù†Ø§Ù…Ø¬ VPN Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…."
echo "   Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ Ù‡ÙŠ Ù…ÙØ§Ù‡ÙŠÙ…ÙŠØ© ÙˆÙ‚Ø¯ Ù„Ø§ ÙŠÙƒÙˆÙ† Ù„Ù‡Ø§ ØªØ£Ø«ÙŠØ± Ù…Ø¨Ø§Ø´Ø±."
echo ""

# Ù‚Ø¯ ØªØ­Ø§ÙˆÙ„ Ø¨Ø¹Ø¶ Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„ØªØ¹ØªÙŠÙ… ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø­Ø²Ù…Ø© (MTU/MSS)
# ÙˆÙ…Ø¹ Ø°Ù„ÙƒØŒ ÙŠØ¬Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø­Ø°Ø± Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªØ¬Ø²Ø¦Ø©.
# net.ipv4.tcp_mtu_probing = 0
# net.ipv4.tcp_base_mss = 1400 # Ù…Ø«Ø§Ù„ Ù„Ù‚ÙŠÙ…Ø© MSS

# Ø¨Ø¹Ø¶ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ù‚Ø¯ ØªØªØ¶Ù…Ù† ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ø§Ù…Ø§Øª TCP (Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ UDP)
# net.ipv4.tcp_synack_retries = 2

# ==== ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ø© ====

fs.file-max = 1048576
fs.inotify.max_user_watches = 524288
vm.swappiness = 10

# ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
sudo sysctl -p

echo "âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª sysctl Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø¹ Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ…ÙˆÙŠÙ‡ UDP - Ù…ÙØ§Ù‡ÙŠÙ…ÙŠØ©)!"

# Ø¶Ø¨Ø· Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙØªÙˆØ­Ø© (ulimit)
echo "ðŸ”§ Ø±ÙØ¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙØªÙˆØ­Ø©..."

sudo ulimit -n 1048576

# Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø¯Ø§Ø¦Ù…Ø©
sudo cat >> /etc/security/limits.conf <<EOF
* soft nofile 1048576
* hard nofile 1048576
EOF

echo "âœ… ØªÙ… Ø¶Ø¨Ø· limits.conf Ø¨Ù†Ø¬Ø§Ø­!"

echo ""
echo "ðŸ’¡ **Ù‡Ø§Ù…:** ØªÙ…ÙˆÙŠÙ‡ Ø§ØªØµØ§Ù„Ø§Øª UDP ÙŠØªÙ… Ø¨Ø´ÙƒÙ„ Ø£Ø³Ø§Ø³ÙŠ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¨Ø±Ù†Ø§Ù…Ø¬ VPN Ø§Ù„Ø°ÙŠ ØªØ³ØªØ®Ø¯Ù…Ù‡."
echo "   ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø±Ù†Ø§Ù…Ø¬ VPN Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ø®ÙŠØ§Ø±Ø§Øª Ù…Ø«Ù„ ObfuscationØŒ ScrambleØŒ"
echo "   Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ø§Øª Ù…Ø«Ù„ Shadowsocks Ø£Ùˆ Obfsproxy ÙƒÙˆÙƒÙŠÙ„ Ù„Ù€ OpenVPN."
echo ""
echo "   Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ sysctl Ù‚Ø¯ ØªØ³Ø§Ø¹Ø¯ ÙÙŠ ØªÙ‚Ù„ÙŠÙ„ Ø¨Ø¹Ø¶ Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ù„Ø§ØªØµØ§Ù„ØŒ"
echo "   Ù„ÙƒÙ† Ø§Ù„ØªÙ…ÙˆÙŠÙ‡ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ ÙŠØ­Ø¯Ø« Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ ØªØ·Ø¨ÙŠÙ‚ VPN."
echo ""
echo "ðŸš€ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª."
echo "Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø¢Ù† Ø§ÙƒØªØ¨: sudo reboot"
